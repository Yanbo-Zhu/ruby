

在现实世界中，字符串是将一个个字符串联起来的。 编程中的字符串与真实字符串无关。

编程中的字符串用于存储字母和数字的集合。它可以是一个单一的字母，如“`a`”，或者像“`hi`”这样一个单词，或者“`Hello my friends.`”这样的一段话。

# 1 编写一个字符串

Ruby字符串被定义为一个引号(`"`)，后跟零个或多个字母，数字或符号，后跟一个闭包引号(`"`)。 最短的字符串称为空字符串：`""`。 单个字符串包含文本的段落甚至页面也很常见。

字符串是表示一个或多个单词的一组字母。 字符串通过在单(`'`)或双(`"`)引号内包含文本来定义。

**示例：**

- 两个字符串之间可以使用`+`号进行连接。

```shell
irb(main):005:0> "Yii" + "Bai" + ".com"
=> "YiiBai.com"
irb(main):006:0> 'Yii' + 'Bai' + '.com'
=> "YiiBai.com"
irb(main):007:0> 'Yiibai' + ".com"
=> "Yiibai.com"
irb(main):008:0>
```

- 将数字字符串与数字相乘将重复该字符串多次。

```shell
irb(main):008:0> "1" + "2" + "3"
=> "123"
irb(main):009:0> "yiibai" * 3
=> "yiibaiyiibaiyiibai"
irb(main):010:0> 'yii@ ' * 3
=> "yii@ yii@ yii@ "
irb(main):011:0>
```



# 2 子字符串

通常使用字符串，可从整个长字符串提取出来的一部分 - 这提取出来的部分称为**子字符串**。在 `irb` 尝试这些例子：

```shell
irb(main):017:0> string = "Ruby in 30 Minutes at yiibai.com"
=> "Ruby in 30 Minutes at yiibai.com"
irb(main):018:0> string[0..8]
=> "Ruby in 3"
irb(main):019:0> string[8..16]
=> "30 Minute"
irb(main):020:0> string[8..-1]
=> "30 Minutes at yiibai.com"
irb(main):021:0> string[8..-2]
=> "30 Minutes at yiibai.co"
irb(main):022:0>
```

**正号和负号的位置**

字符串中的字符每个都有一个位置编号，它们从零开始。 所以对于字符串中的开头“Ru”，“R”位置编号为`0`，“`u`”所在的位置编号为`1`。

要在主字符串中提取出一个子串，可指定提取的起始位置和结束位置。 因此，上面的`string[0..8]`提取出位置从`0`至`8`的字母，也就是：“`Ruby in 3`”。

Ruby解释负的位置从字符串的末尾返回。所以在上面示例中，结尾的字符串“`com`”的字母分别对应为“`m`”位于`-1`，“`o`”位于`-2` 和 “`c`”位于`-3` 。

所以如果一个字母同时有正数和负数的位置，那么应该使用哪个？ 建议使用正数，因为这样它们更容易理解。 但是，如果要基于字符串末尾查找东西(例如“该字符串的最后一个字符是什么？”)，则使用负数指定位置。




在方括号`[]`的帮助下，可以访问Ruby字符串中不同部分的元素。在方括号内写入索引或字符串。

**示例：**

```ruby
#!/usr/bin/ruby   

msg = "This tutorial is from Yiibai.com."   

puts msg["Yiibai"]   
puts msg["tutorial"]   

puts msg[0]   

puts msg[0, 2]   
puts msg[0..19]   
puts msg[0, msg.length]   
puts msg[-3]
```

执行上面代码，得到以下结果 -

```
F:\worksp\ruby>ruby string-elements.rb
Yiibai
tutorial
T
Th
This tutorial is fro
This tutorial is from Yiibai.com.
o

F:\worksp\ruby>
```




# 3 常用的字符串方法

在IRB中使用字符串(对象)中一些常用的方法。

**.length**

`length`方法用于求出字符串中有多少个字符(包括空格)：

```shell
irb(main):022:0> string = "0123456789"
=> "0123456789"
irb(main):023:0> string.length
=> 10
irb(main):024:0> string = "maxsu"
=> "maxsu"
irb(main):025:0> string.length
=> 5
irb(main):026:0>
```

> 尝试：计算你的名字的总长度

**.split**

有时想要将一个字符串分成几部分。 例如，假设有一个存储为字符串的句子，并将其分解成单词：

```shell
C:\Users\Administrator>irb
irb(main):001:0> string = "This is my sample sentence."
=> "This is my sample sentence."
irb(main):002:0> string.split
=> ["This", "is", "my", "sample", "sentence."]
irb(main):003:0>
```

`.split`方法返回一个数组，这将在后面的部分讲解中了解到。 它默认使用空格(“ ”)字符将字符串分割成多个部分。

**.split使用参数**

但有时要分割的不是一个带有空格的字符。 `.split`方法接受一个参数来指定分隔符，看看下面示例就明白了。

```shell
irb(main):003:0> numbers = "1,2,3,4,5,6,7,8"
=> "1,2,3,4,5,6,7,8"
irb(main):004:0> numbers.split
=> ["1,2,3,4,5,6,7,8"]
irb(main):005:0> numbers.split(",")
=> ["1", "2", "3", "4", "5", "6", "7", "8"]
irb(main):006:0>
```

在第一次分割的调用中，它尝试使用空格作为分隔符，但字符串中没有分隔符，所以得到一个整个字符串的数组。 在第二次尝试中，指定使用逗号(“`,`“)作为分隔符，所以得到一个`8`个数字值的数组。

**.sub 和 .gsub**

这两种方法可以用来替换字符串的部分。它们就像在文字处理器中使用“查找和替换”。 `.sub`替换只发生一次。 而`.gsub`全局替换的缩写，替换所有的发生(如“全部替换”)。

对于`.sub`和`.gsub`，需要指定两个参数：首先是要替换的子字符串，然后再替换要替换的字符串。

```shell
irb(main):013:0> greeting = "Hello, Hello Everyone!"
=> "Hello, Hello Everyone!"
irb(main):014:0> greeting.sub("Hello","Hi")
=> "Hi, Hello Everyone!"
irb(main):015:0> greeting.gsub("Hello","Hi")
=> "Hi, Hi Everyone!"
irb(main):016:0>
```

# 4 组合字符串和变量

将变量的值与字符串相结合这是在开发应用程序中最经常使用的。 例如，现在从下面这个例子开始：

```ruby
"Good morning, ?? !"
```

当把上面语句放入`IRB`时，它只是打印输出同一个字符串。 如果编写一个应用程序，希望它以用户名而不是“`??`”来跟用户打招呼，那么需要怎么做？

需要做的就是将变量与字符串组合。有两种方法可以做到这一点。

**方法-1. 字符串连接**

第一种方法，可使用字符串连接，它将字符串与加号连接：

```ruby
irb(main):021:0> name = "Maxsu"
=> "Maxsu"
irb(main):022:0> puts "Good morning, " + name + " ! "
Good morning, Maxsu !
=> nil
irb(main):023:0>
```

在第一行中，设置了一个`name`变量来保存名称。 在第二行，打印字符串“`Good morning`“ 并结合”`name`“变量和字符串”`!`“的值。

**方法-2. 字符串插值**

第二种方法是使用字符串插值，将数据粘贴到字符串的中间。

字符串插值仅适用于双引号字符串。在字符串内使用插值标记`#{}`。 在这些括号中可以把任何变量或Ruby代码放入其中，这些变量或Ruby代码将被评估求值，其结果转换为一个字符串，并输出到外部字符串的那个位置。 上面的例子可以这样重写：

```shell
irb(main):023:0> name = "Maxsu"
=> "Maxsu"
irb(main):024:0> puts "Good morning, #{name}!"
Good morning, Maxsu!
=> nil
irb(main):025:0>
```

如果比较输出结果，就会看到它们输出的是完全相同的结果。 内插样式往往是输入较少的字符类型，较少的双引号打开/关闭，所以可避免加双引号时忘记书写对称(往往有输入多一个，少一个的问题)。


**内插插入代码**

还可以将任何Ruby代码或计算表达式内置在括号内，如下所示：

```shell
irb(main):025:0> modifier = "very "
=> "very "
irb(main):026:0> mood = "excited"
=> "excited"
irb(main):028:0> puts "I am #{modifier * 3 + mood} for today's play!"
I am very very very excited for today's play!
=> nil
irb(main):029:0>
```

首先对`#{modifier * 3 + mood}`代码块进行评估求值，然后将结果注入外部字符串中。

# 5 字符串中引号的使用

Ruby中的单引号与双引号的使用与shell语法相似，即**双引号**可以**转义**或插入变量与运算，而**单引号**会将其中的内容**全部当作字符串**。

```ruby
p1 = "欢迎关注\nlitecdows"
p2 = '欢迎关注这个博主\nlitecdows'
puts p1
puts p2
mvp = "#{50+40+90}" 
puts mvp
mvp = '#{50+40+90}'
puts mvp
```


# 6 多行字符串

在Ruby语言中编写多行字符串非常简单。下面是显示打印多行字符串的三种方式。

- 字符串可以写在双引号内。
- 使用`％`字符，字符串包含在`/`字符内。
- 在`heredoc`语法中，使用`<<`并且字符串包含在单词`STRING`内。

**示例代码：**

```ruby
#!/usr/bin/ruby   
puts "   
A   
AB   
ABC   
ABCD"   

puts %/   
A   
AB   
ABC   
ABCD/   

puts <<STRING
A   
AB   
ABC   
ABCD   
STRING
```

执行上面代码，得到以下结果 -

```
F:\worksp\ruby>ruby string-multiline.rb

A
AB
ABC
ABCD

A
AB
ABC
ABCD
A
AB
ABC
ABCD

F:\worksp\ruby>
```

# 7 变量插值

Ruby变量插值是使用字符串文字中的值替换变量。变量名称放在字符串文字中的`＃{`和`}`字符之间。

**示例代码：**

```ruby
#!/usr/bin/ruby   

country = "China"   
capital = "Beijing"   

puts "#{capital} is the capital of #{country}."
```

执行上面代码，得到以下结果 -

```shell
F:\worksp\ruby>ruby string-variable-interpo.rb
Beijing is the capital of China.

F:\worksp\ruby>
```

# 8 连接字符串

Ruby连接字符串是要使用多个字符串来创建一个字符串。可以通过连接多个字符串来形成单个字符串。

将Ruby字符串连接成单个字符串有四种方法：

- 在每个字符串之间使用加(`+`)号。
- 在每个字符串之间使用单个空格。
- 在每个字符串之间使用`<<`符号。
- 在字符串之间使用`concat`方法。

**示例**

```ruby
#!/usr/bin/ruby   

string = "This is Ruby Tutorial" + " from Yiibai." + " Wish you all good luck."   
puts string   

string = "This is Ruby Tutorial" " from Yiibai." " Wish you all good luck."   
puts string   

string = "This is Ruby Tutorial" << " from Yiibai." << " Wish you all good luck."   
puts string   

string = "This is Ruby Tutorial".concat(" from Yiibai.").concat(" Wish you all good luck.")   
puts string
```

执行上面代码，得到以下结果 -

```shell
F:\worksp\ruby>ruby string-concatenating.rb
This is Ruby Tutorial from Yiibai. Wish you all good luck.
This is Ruby Tutorial from Yiibai. Wish you all good luck.
This is Ruby Tutorial from Yiibai. Wish you all good luck.
This is Ruby Tutorial from Yiibai. Wish you all good luck.

F:\worksp\ruby>
```

# 9 冻结字符串

在大多数编程语言中，字符串是不可变的。现有的字符串不能修改，只能创建一个新的字符串。

在Ruby中，默认的字符串是可变的。为了使它们不可修改，可以使用`freeze`方法。

**示例**

```ruby
#!/usr/bin/ruby   

str = "Original string"   
str << " is modified "   
str << "is again modified"   

puts str   

str.freeze   

## 试着去修改看看
str << "is again modified"   

puts str

#str << "And here modification will be failed after using freeze method"
```

执行上面代码，得到以下结果 -

```shell
F:\worksp\ruby>ruby string-freezing.rb
Original string is modified is again modified
Original string is modified is again modified

F:\worksp\ruby>ruby string-freezing.rb
Original string is modified is again modified
string-freezing.rb:11:in `<main>': can't modify frozen String (RuntimeError)

F:\worksp\ruby>
```

# 10 比较字符串

Ruby字符串可以使用以下三个运算符进行比较：

- 使用`==`运算符：返回`true`或`false`
- 使用 `eql?` 运算符：返回`true`或`false`
- 使用`casecmp`方法：如果匹配则返回`0`，如果不匹配则返回`1`。

**示例**

```ruby
#!/usr/bin/ruby

puts "abc" == "abc"   
puts "as ab" == "ab ab"   
puts "23" == "32"   

puts "ttt".eql? "ttt"   
puts "12".eql? "12"   

puts "Java".casecmp "Java"   
puts "Java".casecmp "java"   
puts "Java".casecmp "ja"
```

执行上面代码，得到以下结果 -

```shell
F:\worksp\ruby>ruby string-comparing.rb
true
false
false
true
true
0
0
1

F:\worksp\ruby>
```

//更多请阅读：https://www.yiibai.com/ruby/strings.html


